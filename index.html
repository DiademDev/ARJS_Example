<!DOCTYPE html>
<html>
    <head>
        <title>Consistent Object Rotation</title>
        <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.min.js"></script>
    </head>
    <body>
        <a-scene embedded arjs>
            <!-- Enable cursor for click detection -->
            <a-entity cursor="rayOrigin: mouse" raycaster="objects: .clickable"></a-entity>
            
            <!-- Load scene assets -->
            <a-assets>
                <a-asset-item id="text" src="Text.glb"></a-asset-item>
            </a-assets>

            <a-marker preset="hiro">
                <!-- Parent entity to control consistent rotation -->
                <a-entity id="parentEntity" position="0 0.5 0">
                    <!-- Animated rotating model -->
                    <a-entity 
                        gltf-model="#text" 
                        class="clickable" 
                        position="0 0 0"
                        id="animatedBox"
                        animation__rotate="property: rotation; to: 0 360 0; loop: true; dur: 5000; easing: linear;">
                    </a-entity>
                </a-entity>
            </a-marker>

            <a-entity camera></a-entity>
        </a-scene>

        <script>
            // Select the animated entity
            const animatedBox = document.querySelector('#animatedBox');
            const parentEntity = document.querySelector('#parentEntity');
            let isAnimating = true; // Track animation state

            // Add click event listener to toggle animation
            animatedBox.addEventListener('click', () => {
                if (isAnimating) {
                    // Stop the animation by setting enabled: false and reset the rotation
                    animatedBox.setAttribute('animation__rotate', 'enabled', false);
                    // Reset the rotation to the initial state (0 0 0)
                    animatedBox.setAttribute('rotation', '0 0 0');
                } else {
                    // Restart the animation with the same configuration
                    animatedBox.setAttribute('animation__rotate', 'enabled', true);
                }
                isAnimating = !isAnimating;
            });

            // Optional: Listen for orientation changes and adjust the parent entity's rotation
            window.addEventListener('orientationchange', () => {
                // You can modify the rotation here if needed, for example:
                parentEntity.setAttribute('rotation', '0 0 0');
            });
        </script>
    </body>
</html>
